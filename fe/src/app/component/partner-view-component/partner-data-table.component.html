<div class="partner-data-table-component">
    <mat-sidenav-container [hasBackdrop]="false">
        <mat-sidenav #sideNav position="end" mode="side" [disableClose]="true" [fixedInViewport]="true" fixedTopGap="65">
            <mat-icon (click)="onCloseSideNav($event)" class="close-icon">close</mat-icon>
            <div class="side-nav">
                <app-partner-attribute-table *ngIf="selectedTablePricedItem"
                                             [item]="selectedTablePricedItem"
                                             [attributes]="attributes">
                </app-partner-attribute-table>
            </div>
        </mat-sidenav>
        <mat-sidenav-content>
            <div class="table-container">
            <mat-table [dataSource]="datasource">
                <ng-container matColumnDef="selection" sticky>
                    <mat-header-cell class="selection-header" *matHeaderCellDef>
                        <mat-checkbox (change)="masterToggle($event)"
                                      [checked]="isMasterToggleChecked()"
                                      [indeterminate]="isMasterToggleIndetermine()">
                        </mat-checkbox>
                    </mat-header-cell>
                    <mat-cell class="selection" *matCellDef="let tableItem">
                        <mat-checkbox (change)="nonMasterToggle($event, tableItem)"
                                      [checked]="isNonMasterToggleChecked(tableItem)">
                        </mat-checkbox>
                    </mat-cell>
                </ng-container>

                <ng-container matColumnDef="name">
                    <mat-header-cell class="attribute-header" *matHeaderCellDef>Name</mat-header-cell>
                    <mat-cell class="attribute" *matCellDef="let tableItem">
                        {{tableItem.name}}
                    </mat-cell>
                </ng-container>

                <ng-container matColumnDef="description">
                    <mat-header-cell class="attribute-header" *matHeaderCellDef>Description</mat-header-cell>
                    <mat-cell class="attribute" *matCellDef="let tableItem">
                        {{tableItem.description}}
                    </mat-cell>
                </ng-container>

                <ng-container matColumnDef="actions" sticky>
                    <!-- warn: for some reason styling doesn't work when resides in scss file -->
                    <mat-header-cell class="acts-header"
                         [ngStyle]="{
                            'min-width': '50px',
                            'display': 'flex',
                            'justify-content': 'flex-start',
                            'align-content': 'center',
                            'line-height': '50px'
                         }" *matHeaderCellDef>&nbsp;</mat-header-cell>
                    <mat-cell class="acts"
                        [ngStyle]="{
                            'min-width': '50px',
                            'display': 'flex',
                            'justify-content': 'flex-start',
                            'align-items': 'center',
                            'line-height': '50px'
                        }" *matCellDef="let tableItem">
                        <mat-icon (click)="onViewDetailsClicked(tableItem)">more</mat-icon>
                    </mat-cell>
                </ng-container>

                <ng-container matColumnDef="children-actions" sticky>
                    <mat-header-cell *matHeaderCellDef></mat-header-cell>
                    <mat-cell *matCellDef="let tableItem">
                        <mat-icon (click)="onViewDetailsClicked(tableItem)">queue</mat-icon>
                    </mat-cell>
                </ng-container>

                <ng-container matColumnDef="children-selection" sticky>
                    <mat-header-cell class="selection-header" *matHeaderCellDef></mat-header-cell>
                    <mat-cell class="selection" *matCellDef="let tableItem"></mat-cell>
                </ng-container>

                <ng-container matColumnDef="expansion" sticky>
                    <mat-header-cell class="expansion-header" *matHeaderCellDef></mat-header-cell>
                    <mat-cell class="expansion" *matCellDef="let tableItem">
                        <mat-icon class="selectable" *ngIf="!isRowExpanded(tableItem)" (click)="rowClicked(tableItem)">chevron_right</mat-icon>
                        <mat-icon class="selectable" *ngIf="isRowExpanded(tableItem)" (click)="rowClicked(tableItem)">expand_more</mat-icon>
                    </mat-cell>
                </ng-container>

                <ng-container matColumnDef="children-expansion" sticky>
                    <mat-header-cell class="expansion-header" *matHeaderCellDef></mat-header-cell>
                    <mat-cell class="expansion" *matCellDef="let tableItem">
                        <div class="depth-{{tableItem.depth}}">
                            <mat-icon>last_page</mat-icon>
                        </div>
                    </mat-cell>
                </ng-container>


                <ng-container *ngFor="let attribute of attributes">
                    <ng-container [matColumnDef]="''+attribute.id">
                        <mat-header-cell class="attribute-header" *matHeaderCellDef>{{attribute.name}}</mat-header-cell>
                        <mat-cell class="attribute" *matCellDef="let tableItem">
                            {{getItemValue(tableItem, attribute) | itemAttributeValueAsString:attribute}}
                        </mat-cell>
                    </ng-container>
                </ng-container>

                <mat-header-row class="item-header" *matHeaderRowDef="displayedColumns"></mat-header-row>
                <mat-row class="item" *matRowDef="let tableItem; columns: displayedColumns;"></mat-row>
                <mat-row class="item" *matRowDef="let tableItem; columns: childrenDisplayedColumns; when: isChildRow"
                         [@detailExpand]="isAnyParentRowExpanded(tableItem) ? 'expanded' : 'collapsed'"></mat-row>
            </mat-table>
            </div>
        </mat-sidenav-content>
    </mat-sidenav-container>
</div>
